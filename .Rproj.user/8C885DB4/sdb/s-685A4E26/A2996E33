{
    "collab_server" : "",
    "contents" : "```{r include_packages_2, include = FALSE}\n# This chunk ensures that the thesisdown package is\n# installed and loaded. This thesisdown package includes\n# the template files for the thesis and also two functions\n# used for labeling and referencing\nif(!require(devtools))\n  install.packages(\"devtools\", repos = \"http://cran.rstudio.com\")\nif(!require(dplyr))\n    install.packages(\"dplyr\", repos = \"http://cran.rstudio.com\")\nif(!require(ggplot2))\n    install.packages(\"ggplot2\", repos = \"http://cran.rstudio.com\")\nif(!require(ggplot2))\n    install.packages(\"bookdown\", repos = \"http://cran.rstudio.com\")\nif(!require(thesisdown)){\n  library(devtools)\n  devtools::install_github(\"ismayc/thesisdown\")\n  }\nlibrary(thesisdown)\nflights <- read.csv(\"data/flights.csv\")\n```\n\n# Data Analysis\n## Changes in Largest Holdings by Average Weight by Index\nThe top 5 largest holdings in the US Equal Weight Index by average weight are Apple, Exxon Mobil, Microsoft, General Electric, and Johnson & Johnson.\n\n```{r, echo = FALSE}\nload(\"~/thesis_final/data/usa.Rda\")\n\nusa_topweight <- aggregate(weight ~ ticker, data=usa, FUN=sum)\nusa_topweight <- arrange(usa_topweight, desc(weight))\nusa_topweight$weight <- usa_topweight$weight/63\nusa_topweight$rank <- seq.int(nrow(usa_topweight))\n```\n\n```{r fig.cap = paste(\"Top 5 Holdings in US Equal Weight Index over Time by Average Weight\"), echo=FALSE}\n\nusa_topweight <- select(usa_topweight, rank, ticker, weight)\nusa_topweight <- usa_topweight[1:5,]\n\nkable(usa_topweight, \n      col.names = c(\"Rank\", \"Ticker\", \"Average Weight\"),\n      caption = \"Top 5 Holdings in the US Equal Weight Index over Time by Average Weight\",\n      longtable = TRUE,\n      booktabs = TRUE)\n```\n\n```{r, echo = FALSE}\nload(\"~/thesis_final/data/usa.Rda\")\nload(\"~/thesis_final/data/minvol.Rda\")\n\nusa_sub1 <- filter(usa, ticker == \"AAPL\" | ticker == \"XOM\" | ticker == \"MSFT\" | ticker == \"GE\" | ticker == \"JNJ\")\nusa_sub1 <- select(usa_sub1, date, ticker, weight)\n\nlibrary(ggplot2)\n\nholdings1<- ggplot() + \n\tgeom_line(data = filter(usa_sub1, ticker == \"AAPL\"), aes(x = date, y = weight, color = \"AAPL\")) +\n\tgeom_line(data = filter(usa_sub1, ticker == \"XOM\"), aes(x = date, y = weight, color = \"XOM\"))  +\n\tgeom_line(data = filter(usa_sub1, ticker == \"MSFT\"), aes(x = date, y = weight, color = \"MSFT\"))  +\n\tgeom_line(data = filter(usa_sub1, ticker == \"GE\"), aes(x = date, y = weight, color = \"GE\"))  +\n\tgeom_line(data = filter(usa_sub1, ticker == \"JNJ\"), aes(x = date, y = weight, color = \"JNJ\"))  +\n\txlab('date') + ylab('weight') + ggtitle('Average Weight Change of  Top 5 Holdings in the US Equal Weight Index')\n```\n\n``` {r fig.cap = paste(\"The 5 largest holdings of the US Equal Weight Index are AAPLE, XOM, MSFT, GE, and JNJ. The weights of the 5 companies start off very high, a few percent of the overall index, then suddenly all drop significantly to a fraction of a percent after 2015-08-31. After calling iShares and MSCI to verify this in the data, it was discovered this due to change in the weighting mechanism.\"), echo=FALSE}\nplot(holdings1)\n```\n\nThe top 5 largest holdings in the Minimum Volatility Index by average weight are Verizon, AT&T, Automatic Data Processing, Johnson & Johnson, and McDonald's. \n\n```{r, echo = FALSE}\nload(\"~/thesis_final/data/minvol.Rda\")\n\nminvol_topweight <- aggregate(weight ~ ticker, data=minvol, FUN=sum)\nminvol_topweight <- arrange(minvol_topweight, desc(weight))\nminvol_topweight$weight <- minvol_topweight$weight/63\nminvol_topweight$rank <- seq.int(nrow(minvol_topweight))\n```\n\n```{r fig.cap = paste(\"Top 5 Holdings in Minimum Volatility Index over Time by Average Weight\"), echo=FALSE}\n\nminvol_topweight <- select(minvol_topweight, rank, ticker, weight)\nminvol_topweight <- minvol_topweight[1:5,]\n\nkable(minvol_topweight, \n      col.names = c(\"Rank\", \"Ticker\", \"Average Weight\"),\n      caption = \"Top 5 Holdings in the Minimum Volatility Index over Time by Average Weight\",\n      longtable = TRUE,\n      booktabs = TRUE)\n```\n\n```{r, echo = FALSE}\nload(\"~/thesis_final/data/minvol.Rda\")\nminvol_sub1 <- filter(minvol, ticker == \"VZ\" | ticker == \"T\" | ticker == \"ADP\" | ticker == \"JNJ\" | ticker == \"MCD\")\nminvol_sub1 <- select(minvol_sub1, date, ticker, weight)\n\nlibrary(ggplot2)\n\nholdings2<- ggplot() + \n\tgeom_line(data = filter(minvol_sub1, ticker == \"VZ\"), aes(x = date, y = weight, color = \"VZ\")) +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"T\"), aes(x = date, y = weight, color = \"T\"))  +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"ADP\"), aes(x = date, y = weight, color = \"ADP\"))  +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"JNJ\"), aes(x = date, y = weight, color = \"JNJ\"))  +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"MCD\"), aes(x = date, y = weight, color = \"MCD\"))  +\n\txlab('date') + ylab('weight') + ggtitle('Average Weight Change of  Top 5 Holdings in the Minimum Volatility Index')\n```\n\n``` {r fig.cap = paste(\"The 5 largest holdings of the Minimum Volatility Index are VZ, T, ADP, JNJ, and MCD. Since the index's inception, these stocks have generally remained between a weight of 1.3% and 1.7% of the overall portfolio, with the exception of Verizon, which reached around 2% in 2014.\"), echo=FALSE}\nplot(holdings2)\n```\n\n## Sector Weights\nSector weights were calculated over time for both the US Equal Weight and the Minimum Volatility Index. This was done to get a sense of what industries may be inherently more \"low-risk\" as well as checking to make sure the data is resilient, and each sector weighting in the Minimum Volatility Index is within 5% of the US Equal Weight Index, as specified by the Barra Optimizer. \n\n```{r, echo=FALSE}\nload(\"~/thesis_final/data/usa_percent.Rda\")\nload(\"~/thesis_final/data/minvol_percent.Rda\")\nlibrary(ggplot2)\n```\n\n``` {r fig.cap = paste(\"The weighting of energy in the US Equal Weight Index is consistenty higher than the weighting in the Minimum Volatility Index. This might imply that energy is a more volatile industry when compared to others.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Energy\nEng1 <- usa_percent[which(usa_percent$sector_name==\"Energy\"), ]\nEng2 <- minvol_percent[which(minvol_percent$sector_name==\"Energy\"), ]\nggplot(Eng1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() +  \nggtitle(\"Index Energy Sector Weight Comparisons Over Time\") + xlab(\"Time\") + ylab(\"Sector Weight\") +\ngeom_line(data = Eng2, aes(x=date, y=percent, colour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weighting of financials in the US Equal Weight Index are pretty consistent until a significant decrease towards the latter half of 2016. In the Minimum Volatility Index, the weighting of financials fluctuate quite a bit, and experience a similar drop in weight at the same time as the US Equal Weight Index.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Financials\nFin1 <- usa_percent[which(usa_percent$sector_name==\"Financials\"), ]\nFin2 <- minvol_percent[which(minvol_percent$sector_name==\"Financials\"), ]\nggplot(Fin1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Financial Sector Weight Comparisons Over Time\")+xlab(\"Time\")+ylab(\"Sector Weight\") + \ngeom_line(data = Fin2, aes(x=date, y=percent, colour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weighting of consumer staples in the US Equal Weight Index is consistenty lower than the weighting of consumer staples in the Minimum Volatility Index. This might imply that consumer staples is a low volatile industry.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Consumer Staples\nConStap1 <- usa_percent[which(usa_percent$sector_name==\"Consumer Staples\"), ]\nConStap2 <- minvol_percent[which(minvol_percent$sector_name==\"Consumer Staples\"), ]\nggplot(ConStap1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Consumer Staples Sector Weight Comparisons Over Time\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = ConStap2, aes(x=date, y=percent, \ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weight of consumer discretionary stocks is consistenty higher in the US Equal Weight Index than in the Minimum Volatility Index. This might imply that consumer discretionary is inherently a volatile industry.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Consumer Discretionary\nConDis1 <- usa_percent[which(usa_percent$sector_name==\"Consumer Discretionary\"), ]\nConDis2 <- minvol_percent[which(minvol_percent$sector_name==\"Consumer Discretionary\"), ]\nggplot(ConDis1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Consumer Discretionary Sector Weight Comparisons Over Time\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = ConDis2, aes(x=date, y=percent, \ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weight of healthcare stocks is consistenty higher over time in the Minimum Volatility Index than in the US Equal Weight Index. This could imply that the healthcare sector may not be as volatile as other sectors.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Healthcare\nHealth1 <- usa_percent[which(usa_percent$sector_name==\"Health Care\"), ]\nHealth2 <- minvol_percent[which(minvol_percent$sector_name==\"Health Care\"), ]\nggplot(Health1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Healthcare Sector Weight Comparisons Over Time\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Health2, aes(x=date, y=percent, \ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weight of industrials is consistenty higher over time in the US Equal Weight Index than in the Minimum Volatility Index. This could imply that industrial companies may be more volatile than companies in other sectors.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Industrials\nInd1 <- usa_percent[which(usa_percent$sector_name==\"Industrials\"), ]\nInd2 <- minvol_percent[which(minvol_percent$sector_name==\"Industrials\"), ]\nggplot(Ind1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Industrials Sector Weight Comparisons Over Time\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Ind2, aes(x=date, y=percent, \ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weighting of information technology stocks between 2012 and 2013 were significantly greater in the Minimum Volatility Index than in the US Equal Weight Index. However, since 2014, the weights of IT in both indices have converged, implying the industry may have more volatile over the last few years.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Information Technology\nIT1 <- usa_percent[which(usa_percent$sector_name==\"Information Technology\"), ]\nIT2 <- minvol_percent[which(minvol_percent$sector_name==\"Information Technology\"), ]\nggplot(IT1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Information Technology Sector Weight Comparisons Over Time\") + \nxlab(\"Time\") + ylab(\"Sector Weight\") + geom_line(data = IT2, aes(x=date, y=percent,\ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weight of materials is consistenty higher over time in the US Equal Weight Index than in the Minimum Volatility Index. This could imply that materials companies may be more volatile than companies in other sectors.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Materials\nMat1 <- usa_percent[which(usa_percent$sector_name==\"Materials\"), ]\nMat2 <- minvol_percent[which(minvol_percent$sector_name==\"Materials\"), ]\nggplot(Mat1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Materials Sector Weight Comparisons Over Time\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Mat2, aes(x=date, y=percent, \ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weight of utilities stocks is higher over time in the Minimum Volatility Index than in the US Equal Weight Index. This could imply that the utilities sector may not be as volatile as other sectors.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Utilites\nUtil1 <- usa_percent[which(usa_percent$sector_name==\"Utilities\"), ]\nUtil2 <- minvol_percent[which(minvol_percent$sector_name==\"Utilities\"), ]\nggplot(Util1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Utilites Sector Weight Comparisons Over Time\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Util2, aes(x=date, y=percent, \ncolour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n``` {r fig.cap = paste(\"The weight of telecommunications stocks is higher over time in the Minimum Volatility Index than in the US Equal Weight Index. However, over time the weight of telecommunications has consistently decreased, which would imply the industry has gotten more volatile over the past few years.\"), fig.height=3.5, fig.width=6.5, echo=FALSE}\n## Telecommunication Services\nTelecom1 <- usa_percent[which(usa_percent$sector_name==\"Telecommunications\"), ]\nTelecom2 <- minvol_percent[which(minvol_percent$sector_name==\"Telecommunications\"), ]\nggplot(Telecom1, aes(date, percent, colour = \"US Equal Weight\")) + geom_line() + \nggtitle(\"Index Telecommunication Sector Weight Comparisons Over Time\") + \nxlab(\"Time\") + ylab(\"Sector Weight\") + geom_line(data = Telecom2, aes(x=date, \ny=percent, colour=\"Minimum Volatility\"),show.legend = TRUE)\n```\n\n\\clearpage \n\n\n## Trailing Volatilities \nData was collected from 10/31/2010 to 12/30/2016, from Wharton Research Data Services (WRDS) for the 908 historical constituents of the USA Equal Weight (EUSA) ETF, of which the Minimum Volatility Index is derived. Each tickers' 252-day (annual) trailing volatility was calculated, and a month end spagetti plot was produced for stocks in the Minimum Volatility Index, and the remainder of the stock comprising the US Equal Weight Index, to get a relative sense of each group's volatility attributes. The stocks comprising the Minimum Volatility Index generally had a lower volatility than those in the US Equal Weight Index.\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\nload(\"~/thesis_final/data/monthly_data.Rda\")\n\nusa_vol <-filter(monthly_data, index_now == 0)\nsummary(usa_vol$volatility)\n\nus_volplot <- ggplot(usa_vol, aes(date, volatility, group = ticker)) + geom_line() + ggtitle(\"52-Week Trailing Volatility for Stocks in the US Equal Weight Index\") + labs(x=\"Date\", y=\"52-week Trailing Volatility\")\n```\n\n``` {r fig.cap = paste(\"The 52-week trailing volatilities for stocks in the US Equal Weight Index ranged from 0.00492 to 87.37030, with a mean value of 1.44738.\"), echo=FALSE}\nplot(us_volplot)\n```\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\nload(\"~/thesis_final/data/monthly_data.Rda\")\n\nminvol_vol <-filter(monthly_data, index_now == 1)\nsummary(minvol_vol$volatility)\n\nminvol_volplot <- ggplot(minvol_vol, aes(date, volatility, group = ticker)) + geom_line() + ggtitle(\"52-Week Trailing Volatility for Stocks in the Minimum Volatility Index\") + labs(x=\"Date\", y=\"52-week Trailing Volatility\")\n```\n\n``` {r fig.cap = paste(\"The 52-week trailing volatilities for stocks in the Minimum Volatility Index ranged from 0.03085 to 34.20974, with a mean value of 1.40784.\"), echo=FALSE}\nplot(minvol_volplot)\n```\n\n## Trailing Betas \nData was collected from 10/31/2010 to 12/30/2016, from Wharton Research Data Services (WRDS) for the 908 historical constituents of the USA Equal Weight (EUSA) ETF, of which the Minimum Volatility Index is derived. Each tickers' 252-day (annual) trailing beta was calculated, and a month end spagetti plot was produced for stocks in the Minimum Volatility Index, and the remainder of the stock comprising the US Equal Weight Index, to get a relative sense of each group's volatility attributes. Generally, the stocks comprising the Minimum Volatility Index had a lower beta than those in the US Equal Weight Index.\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\nload(\"~/thesis_final/data/monthly_data.Rda\")\n\nusa_beta <-filter(monthly_data, index_now == 0)\nsummary(usa_beta$beta)\n\nusa_beta_plot <- ggplot(usa_beta, aes(date, beta, group = ticker)) + geom_line() + ggtitle(\"52-Week Trailing Beta for Stocks in the US Equal Weight Index\") + labs(x=\"Date\", y=\"52-week Trailing Beta\")\n```\n\n``` {r fig.cap = paste(\"The 52-week trailing betas for stocks in the US Equal Weight Index ranged from -4.9037 to 6.4952, with a mean value of 1.1505\"), echo=FALSE}\nplot(usa_beta_plot)\n```\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\nload(\"~/thesis_final/data/monthly_data.Rda\")\n\nminvol_beta <-filter(monthly_data, index_now == 1)\nsummary(minvol_beta$beta)\n\nminvol_beta_plot <- ggplot(minvol_beta, aes(date, beta, group = ticker)) + geom_line() + ggtitle(\"52-Week Trailing Beta for Stocks in the Minimum Volatility Index\") + labs(x=\"Date\", y=\"52-week Trailing Beta\")\n```\n\n``` {r fig.cap = paste(\"The 52-week trailing betas for stocks in the Minimum Volatility Index ranged from -0.2473 to 3.2021, with a mean value of 0.7856\"), echo=FALSE}\nplot(minvol_beta_plot)\n```\n\n\n# Logistic Regression Model \nOnce the final data set was created and cleaned, with a number of response variables including trailing beta, trailing volatility, price to book ratio, and the whether or not a stock was in the Minimum Volatility index or not (1 if in, 0 if not in). Given the nature of the data, a logistic regression was run. Looking at all of the historical data and stock various characteristics, this  modeled the log odds of a stock being in the minimum volatility index as a combination of the linear predictors mentioned. Since the index is rebalanced twice a year, it makes sense to look at a model including the data for both of these months.\n## Data Cleaning\n```{r, echo=FALSE}\nload(\"~/thesis_final/data/monthly_data.Rda\")\n# Subset data for dates from May\nmay_final <- filter(monthly_data, date == \"2012-05-31\" |  date == \"2013-05-31\"| date == \"2014-05-30\" | date == \"2015-05-29\" | date == \"2016-05-31\")\n# Remove NA values from set\nmay_final <- subset(may_final, !is.na(index_before))\n# Subset data for dates from November\nnovember_final <- filter(monthly_data, date == \"2011-11-30\" | date == \"2012-11-30\"| date == \"2013-11-29\"| date == \"2014-11-28\" | date == \"2015-11-30\" | date == \"2016-11-30\")\n# Remove NA values from set\nnovember_final <- subset(november_final, !is.na(index_before))\n\nboth_final <- rbind(may_final, november_final)\n```\n### Removing for Class Bias\nIdeally, the proportion of stocks in and out of the Min Vol index should approximately be the same. However, after checking this, it is clear that this is not the case, as, just around 25% of the data is from stocks that are currently in the index, meaning there is a class bias. As a result, observations must be sampled in approximately equal proportions to get a better model.\n```{r}\ntable(both_final$index_now)\n```\n### Create Training and Test Samples\nOne way to address the problem of class bias is to draw the 0’s and 1’s for the trainingData (development sample) in equal proportions. In doing so, we will put rest of the inputData not included for training into testData (validation sample). As a result, the size of development sample will be smaller that validation, which is okay, because, there are large number of observations.\n```{r, echo=FALSE}\n# Create Training Data\ninput_ones2 <- both_final[which(both_final$index_now == 1), ] \ninput_zeros2 <- both_final[which(both_final$index_now == 0), ]\nset.seed(100)  # for repeatability of samples\ninput_ones_training_rows2 <- sample(1:nrow(input_ones2), 0.7*nrow(input_ones2)) \ninput_zeros_training_rows2 <- sample(1:nrow(input_zeros2), 0.7*nrow(input_ones2))  \ntraining_ones2 <- input_ones2[input_ones_training_rows2, ]  \ntraining_zeros2 <- input_zeros2[input_zeros_training_rows2, ]\ntrainingData <- rbind(training_ones2, training_zeros2)   \n# Create Test Data\ntest_ones2 <- input_ones2[-input_ones_training_rows2, ]\ntest_zeros2 <- input_zeros2[-input_zeros_training_rows2, ]\ntestData <- rbind(test_ones2, test_zeros2) \n```\nThere is no more class bias, as the sample is now evenly weighted now, with each outcome being represented by 969 observations. \n```{r}\ntable(trainingData$index_now)\n```\n\n### Logistic Regression Model \n```{r}\n# Model\nlogit <- glm(index_now ~  volatility + beta + price_to_book \n+ index_before, data=trainingData, family=binomial(link=\"logit\"))\n\n# Summary of Model\nsummary(logit)\n\n# Coefficient Interpretation\n## Log Odds\nexp(coef(logit))\n## Probability \n(exp(coef(logit))) / (1+(exp(coef(logit))))\n``` \n\n### Interpretation of Model\nThe coefficients can be interpreted as: \n\\hfill\\break\n- Volatility: The odds ratio of being added to the index is 0.96 times smaller, given a one unit increase in volatility. This response variable is not statistically significant.\n\\hfill\\break\n- Beta: The odds ratio of being added to the index is 0.015 times smaller, given a one unit increase in beta. This response variable is statistically significant. \n\\hfill\\break\n- Price to Book: The odds ratio of being added to the index is the same, given a one unit increase in price to book ratio. This response variable is not statistically significant. \n\\hfill\\break\n- Index before: The odds ratio of being added to the index is 228.61 times greater if the stock was in the index 6 months ago. This response variable is statistically significant. \n\\hfill\\break\n\\hfill\\break\n\n### Model Quality \nTo test the quality of the model, several tests were done:\n\\hfill\\break\n__Predictive Power__\n\\hfill\\break\nThe default cutoff prediction probability score is 0.5 or the ratio of 1’s and 0’s in the training data. But sometimes, tuning the probability cutoff can improve the accuracy in both the development and validation samples. The InformationValue::optimalCutoff function provides ways to find the optimal cutoff to improve the prediction of 1’s, 0’s, both 1’s and 0’s and to reduce the misclassification error. Here, the optimal cut off is 0.86.\n```{r}\nlibrary(InformationValue)\npredicted <- plogis(predict(logit, testData)) \noptCutOff <- optimalCutoff(testData$index_now, predicted)[1] \noptCutOff\n```\n\\hfill\\break\n__VIF__\n\\hfill\\break\nLike in case of linear regression, we should check for multicollinearity in the model. As seen below, all the variables in the model have VIF well below 4.\n```{r, message=FALSE}\nlibrary(car)\nvif(logit)\n```\n\\hfill\\break\n__Misclassification Error__\n\\hfill\\break\nMisclassification error is the percentage mismatch of predicted vs. actuals, irrespective of 1’s or 0’s. The lower the misclassification error, the better the model. Here it is 4.02%.\n```{r}\nmisClassError(testData$index_now, predicted)\n```\n\\hfill\\break\n__ROC__\n\\hfill\\break\nReceiver Operating Characteristics Curve traces the percentage of true positives accurately predicted by a given logit model as the prediction probability cutoff is lowered from 1 to 0. For a good model, as the cutoff is lowered, it should mark more of actual 1’s as positives and lesser of actual 0’s as 1’s. So for a good model, the curve should rise steeply, indicating that the TPR (Y-Axis) increases faster than the FPR (X-Axis) as the cutoff score decreases. Greater the area under the ROC curve, better the predictive ability of the model. Here, it is 96.77%.\n```{r}\nplotROC(testData$index_now, predicted)\n```\n\\hfill\\break\n__Concordance__\n\\hfill\\break\nIdeally, the model-calculated-probability-scores of all actual Positive’s, (aka Ones) should be greater than the model-calculated-probability-scores of ALL the Negatives (aka Zeroes). Such a model is said to be perfectly concordant and a highly reliable one. This phenomenon can be measured by Concordance and Discordance.\n\nIn simpler words, of all combinations of 1-0 pairs (actuals), Concordance is the percentage of pairs, whose scores of actual positive’s are greater than the scores of actual negative’s. For a perfect model, this will be 100%. So, the higher the concordance, the better is the quality of model. This model has a concordance of 96.8%.\n```{r}\nConcordance(testData$index_now, predicted)\n```\n\\hfill\\break\n__Specificity and Sensitivity__\n\\hfill\\break\n- Sensitivity (or True Positive Rate) is the percentage of 1’s (actuals) correctly predicted by the model, while, specificity is the percentage of 0’s (actuals) correctly predicted. In this model, it was found to be 86.29%.\n\\hfill\\break\n- Specificity can also be calculated as 1 - False Positive Rate. In this model, it was found to be 98.19%. \n```{r}\nsensitivity(testData$index_now, predicted, threshold = optCutOff)\nspecificity(testData$index_now, predicted, threshold = optCutOff)\n```\n\\hfill\\break\n__Confusion Matrix__\n\\hfill\\break\nIn the confusion matrix, the columns are actuals, while rows are predicteds. \n```{r}\nconfusionMatrix(testData$index_now, predicted, threshold = optCutOff)\n```\n",
    "created" : 1509396875410.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "0|42|19|0|\n21|15|283|0|\n22|57|110|0|\n",
    "hash" : "3273455679",
    "id" : "A2996E33",
    "lastKnownWriteTime" : 1509561002,
    "last_content_update" : 1509561002353,
    "path" : "~/thesis_final/index/03-chap3.Rmd",
    "project_path" : "index/03-chap3.Rmd",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}