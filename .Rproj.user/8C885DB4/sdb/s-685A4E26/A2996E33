{
    "collab_server" : "",
    "contents" : "```{r include_packages_2, include = FALSE}\n# This chunk ensures that the thesisdown package is\n# installed and loaded. This thesisdown package includes\n# the template files for the thesis and also two functions\n# used for labeling and referencing\nif(!require(devtools))\n  install.packages(\"devtools\", repos = \"http://cran.rstudio.com\")\nif(!require(dplyr))\n    install.packages(\"dplyr\", repos = \"http://cran.rstudio.com\")\nif(!require(ggplot2))\n    install.packages(\"ggplot2\", repos = \"http://cran.rstudio.com\")\nif(!require(ggplot2))\n    install.packages(\"bookdown\", repos = \"http://cran.rstudio.com\")\nif(!require(thesisdown)){\n  library(devtools)\n  devtools::install_github(\"ismayc/thesisdown\")\n  }\nlibrary(thesisdown)\nflights <- read.csv(\"data/flights.csv\")\n```\n\n# Data Analysis\n## Changes in Largest Holdings by Average Weight in Minimum Volatility Index\nThe top 5 largest holdings in the Minimum Volatility Index by average weight are Verizon, AT&T, Automatic Data Processing, Johnson & Johnson, and McDonald's. \n\n```{r, echo = FALSE, include=FALSE}\nload(\"~/thesis_final/data/minvol.Rda\")\n\nminvol_topweight <- aggregate(weight ~ ticker, data=minvol, FUN=sum)\nminvol_topweight <- arrange(minvol_topweight, desc(weight))\nminvol_topweight$weight <- minvol_topweight$weight/63\nminvol_topweight$rank <- seq.int(nrow(minvol_topweight))\n```\n\n```{r fig.cap = paste(\"Top 5 Holdings in Minimum Volatility Index over Time by Average Weight\"), echo=FALSE, include=FALSE}\n\nminvol_topweight <- select(minvol_topweight, rank, ticker, weight)\nminvol_topweight <- minvol_topweight[1:5,]\n\nkable(minvol_topweight, \n      col.names = c(\"Rank\", \"Ticker\", \"Average Weight\"),\n      caption = \"Top 5 Holdings in the Minimum Volatility Index over Time by Average Weight\",\n      longtable = TRUE,\n      booktabs = TRUE)\n```\n\n```{r, echo = FALSE, include=FALSE}\nload(\"~/thesis_final/data/minvol.Rda\")\nminvol_sub1 <- filter(minvol, ticker == \"VZ\" | ticker == \"T\" | ticker == \"ADP\" | ticker == \"JNJ\" | ticker == \"MCD\")\nminvol_sub1 <- select(minvol_sub1, date, ticker, weight)\n\nlibrary(ggplot2)\n\nholdings2<- ggplot() + \n\tgeom_line(data = filter(minvol_sub1, ticker == \"VZ\"), aes(x = date, y = weight, color = \"VZ\")) +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"T\"), aes(x = date, y = weight, color = \"T\"))  +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"ADP\"), aes(x = date, y = weight, color = \"ADP\"))  +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"JNJ\"), aes(x = date, y = weight, color = \"JNJ\"))  +\n\tgeom_line(data = filter(minvol_sub1, ticker == \"MCD\"), aes(x = date, y = weight, color = \"MCD\"))  +\n\txlab('date') + ylab('weight') + ggtitle('Change in Weights of the Top 5 Holdings in the Minimum Volatility Index over Time')\n```\n\n``` {r fig.cap = paste(\"The 5 largest holdings of the Minimum Volatility Index are VZ, T, ADP, JNJ, and MCD. Since the index's inception, these stocks have generally remained between a weight of 1.3% and 1.7% of the overall portfolio, with the exception of Verizon, which reached around 2% in 2014.\"), echo=FALSE}\nplot(holdings2)\n```\n\n## Sector Weights\nSector weights were calculated over time for both the US Equal Weight and the Minimum Volatility Index. This was done to get a sense of what industries may be inherently more \"low-risk\" as well as checking to make sure the data is resilient, and each sector weighting in the Minimum Volatility Index is within 5% of the US Equal Weight Index, as specified by the Barra Optimizer. \n\n```{r, echo=FALSE}\nload(\"~/thesis_final/data/usa_percent.Rda\")\nload(\"~/thesis_final/data/minvol_percent.Rda\")\nlibrary(ggplot2)\nlibrary(mscidata)\n\n## Energy\nEng1 <- usa_percent[which(usa_percent$sector_name==\"Energy\"), ]\nEng2 <- minvol_percent[which(minvol_percent$sector_name==\"Energy\"), ]\nggplot(Eng1, aes(date, percent, colour = \"USA\")) + geom_line() +  \nggtitle(\"EUSA and USMV Energy Sector Weights\") + xlab(\"Time\") + ylab(\"Sector Weight\") +\ngeom_line(data = Eng2, aes(x=date, y=percent, colour=\"Min Vol\"),show.legend = TRUE)\n\n## Finacials\nFin1 <- usa_percent[which(usa_percent$sector_name==\"Financials\"), ]\nFin2 <- minvol_percent[which(minvol_percent$sector_name==\"Financials\"), ]\nggplot(Fin1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Financial Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + \ngeom_line(data = Fin2, aes(x=date, y=percent, colour=\"Min Vol\"),show.legend = TRUE)\n\n## Consumer Staples\nConStap1 <- usa_percent[which(usa_percent$sector_name==\"Consumer Staples\"), ]\nConStap2 <- minvol_percent[which(minvol_percent$sector_name==\"Consumer Staples\"), ]\nggplot(ConStap1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Consumer Staples Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = ConStap2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Consumer Discretionary\nConDis1 <- usa_percent[which(usa_percent$sector_name==\"Consumer Discretionary\"), ]\nConDis2 <- minvol_percent[which(minvol_percent$sector_name==\"Consumer Discretionary\"), ]\nggplot(ConDis1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Consumer Discretionary Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = ConDis2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Health Care\nHealth1 <- usa_percent[which(usa_percent$sector_name==\"Health Care\"), ]\nHealth2 <- minvol_percent[which(minvol_percent$sector_name==\"Health Care\"), ]\nggplot(Health1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Health Care Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Health2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Industrials\nInd1 <- usa_percent[which(usa_percent$sector_name==\"Industrials\"), ]\nInd2 <- minvol_percent[which(minvol_percent$sector_name==\"Industrials\"), ]\nggplot(Ind1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Industrials Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Ind2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Information Technology\nIT1 <- usa_percent[which(usa_percent$sector_name==\"Information Technology\"), ]\nIT2 <- minvol_percent[which(minvol_percent$sector_name==\"Information Technology\"), ]\nggplot(IT1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Information Technology Sector Weights\") + \nxlab(\"Time\") + ylab(\"Sector Weight\") + geom_line(data = IT2, aes(x=date, y=percent,\ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Materials\nMat1 <- usa_percent[which(usa_percent$sector_name==\"Materials\"), ]\nMat2 <- minvol_percent[which(minvol_percent$sector_name==\"Materials\"), ]\nggplot(Mat1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Materials Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Mat2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Utilites\nUtil1 <- usa_percent[which(usa_percent$sector_name==\"Utilities\"), ]\nUtil2 <- minvol_percent[which(minvol_percent$sector_name==\"Utilities\"), ]\nggplot(Util1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Utilities Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Util2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Telecommunication Services\nTelecom1 <- usa_percent[which(usa_percent$sector_name==\"Telecommunications\"), ]\nTelecom2 <- minvol_percent[which(minvol_percent$sector_name==\"Telecommunications\"), ]\nggplot(Telecom1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Telecommunications Sector Weights\") + \nxlab(\"Time\") + ylab(\"Sector Weight\") + geom_line(data = Telecom2, aes(x=date, \ny=percent, colour=\"Min Vol\"),show.legend = TRUE)\n```\n\n## EUSA Constituent Trailing Volatilities \nData was collected from the past 10 years of the EUSA index. The data was collected from 12/31/2006 to 12/30/2016, from Wharton Research Data Services (WRDS) for the 908 historical constituents of the USA Equal Weight (EUSA) index, of which USMV is derived. Each tickers' 252-day (annual) trailing volatility was calculated and a month end spagetti plot was produced.\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\n\nhead(monthly_rolling_vol)\ntail(monthly_rolling_vol)\nsummary(monthly_rolling_vol)\n\n# Spaggeti plot for monthly trailing vol\nggplot(monthly_rolling_vol, aes(Date, Volatility, group = Ticker)) + geom_line()\n```\n\n## EUSA Constituent Trailing Betas \nData was collected from the past 10 years of the EUSA index. The data was collected from 12/31/2006 to 12/30/2016, was collected from WRDS for the 908 historical constituents of the USA Equal Weight (EUSA) index, of which USMV is derived. Each tickers' 252-day (annual) trailing beta was calculated and a month end spagetti plot was produced.\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\n\nhead(monthly_beta_values)\ntail(monthly_beta_values)\nsummary(monthly_beta_values)\n\n# Spaggeti plot for monthly Beta\nggplot(monthly_beta_values, aes(Date, Beta, group = Ticker)) + geom_line()\n```\n\n## EUSA Constituent Price to Book Ratios \nData was collected from the past 10 years of the EUSA index. The data was collected from 12/31/2006 to 12/30/2016, from WRDS for the 908 historical constituents of the USA Equal Weight (EUSA) index, of which USMV is derived. Each tickers' Price to Book ratio was calculated in two ways, to ensure accuracy. \n\n```{r, echo = FALSE}\nlibrary(ggplot2)\n\nhead(book_value_data)\ntail(book_value_data)\nsummary(book_value_data)\n```\n\n# Data Distribution \nThe distribution of the predictor variable, if the stock is in the index now, with respect to each response variable is shown below. \n\n## Index now vs. Trailing Volatility \n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=volatility, y=index_now)) + geom_point()\n```\n\n## Index now vs. Trailing Beta \n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=beta, y=index_now)) + geom_point() \n```\n\n## Index now vs. Price to Book Ratio \n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=price_to_book, y=index_now)) + geom_point() \n```\n\n## Index now vs. Index 6 months ago\n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=index_before, y=index_now)) + geom_point()\n```\n---\noutput:\n  pdf_document: default\n  html_document: default\n---\n# Data Analysis \n\n## Sector Weights\nSector weights were calculated over time for both EUSA and USMV. Plots were made and displayed to compare the relative sector weights of EUSA and USMV. This was done to get a sense of what industries may be inherently more \"low risk,\" as well as making sure the data is resilient, and each sector weighting is within 5% as specified by the Barra Optimizer. \n\n*Sector Weight Summary Statistics:*\n\n```{r}\ndata(usa_percent)\ndata(minvol_percent)\n\n## Summary statistics of EUSA sector weights\nhead(usa_percent)\ntail(usa_percent)\nsummary(usa_percent)\n\n## Summary statistics of USMV sector weights\nhead(minvol_percent)\ntail(minvol_percent)\nsummary(minvol_percent)\n```\n\n*Sector Weights for EUSA and USMV:*\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\nlibrary(mscidata)\n\n## Energy\nEng1 <- usa_percent[which(usa_percent$sector_name==\"Energy\"), ]\nEng2 <- minvol_percent[which(minvol_percent$sector_name==\"Energy\"), ]\nggplot(Eng1, aes(date, percent, colour = \"USA\")) + geom_line() +  \nggtitle(\"EUSA and USMV Energy Sector Weights\") + xlab(\"Time\") + ylab(\"Sector Weight\") +\ngeom_line(data = Eng2, aes(x=date, y=percent, colour=\"Min Vol\"),show.legend = TRUE)\n\n## Finacials\nFin1 <- usa_percent[which(usa_percent$sector_name==\"Financials\"), ]\nFin2 <- minvol_percent[which(minvol_percent$sector_name==\"Financials\"), ]\nggplot(Fin1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Financial Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + \ngeom_line(data = Fin2, aes(x=date, y=percent, colour=\"Min Vol\"),show.legend = TRUE)\n\n## Consumer Staples\nConStap1 <- usa_percent[which(usa_percent$sector_name==\"Consumer Staples\"), ]\nConStap2 <- minvol_percent[which(minvol_percent$sector_name==\"Consumer Staples\"), ]\nggplot(ConStap1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Consumer Staples Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = ConStap2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Consumer Discretionary\nConDis1 <- usa_percent[which(usa_percent$sector_name==\"Consumer Discretionary\"), ]\nConDis2 <- minvol_percent[which(minvol_percent$sector_name==\"Consumer Discretionary\"), ]\nggplot(ConDis1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Consumer Discretionary Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = ConDis2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Health Care\nHealth1 <- usa_percent[which(usa_percent$sector_name==\"Health Care\"), ]\nHealth2 <- minvol_percent[which(minvol_percent$sector_name==\"Health Care\"), ]\nggplot(Health1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Health Care Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Health2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Industrials\nInd1 <- usa_percent[which(usa_percent$sector_name==\"Industrials\"), ]\nInd2 <- minvol_percent[which(minvol_percent$sector_name==\"Industrials\"), ]\nggplot(Ind1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Industrials Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Ind2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Information Technology\nIT1 <- usa_percent[which(usa_percent$sector_name==\"Information Technology\"), ]\nIT2 <- minvol_percent[which(minvol_percent$sector_name==\"Information Technology\"), ]\nggplot(IT1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Information Technology Sector Weights\") + \nxlab(\"Time\") + ylab(\"Sector Weight\") + geom_line(data = IT2, aes(x=date, y=percent,\ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Materials\nMat1 <- usa_percent[which(usa_percent$sector_name==\"Materials\"), ]\nMat2 <- minvol_percent[which(minvol_percent$sector_name==\"Materials\"), ]\nggplot(Mat1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Materials Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Mat2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Utilites\nUtil1 <- usa_percent[which(usa_percent$sector_name==\"Utilities\"), ]\nUtil2 <- minvol_percent[which(minvol_percent$sector_name==\"Utilities\"), ]\nggplot(Util1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Utilities Sector Weights\") + xlab(\"Time\") + \nylab(\"Sector Weight\") + geom_line(data = Util2, aes(x=date, y=percent, \ncolour=\"Min Vol\"),show.legend = TRUE)\n\n## Telecommunication Services\nTelecom1 <- usa_percent[which(usa_percent$sector_name==\"Telecommunications\"), ]\nTelecom2 <- minvol_percent[which(minvol_percent$sector_name==\"Telecommunications\"), ]\nggplot(Telecom1, aes(date, percent, colour = \"USA\")) + geom_line() + \nggtitle(\"EUSA and USMV Telecommunications Sector Weights\") + \nxlab(\"Time\") + ylab(\"Sector Weight\") + geom_line(data = Telecom2, aes(x=date, \ny=percent, colour=\"Min Vol\"),show.legend = TRUE)\n```\n\n## EUSA Constituent Trailing Volatilities \nData was collected from the past 10 years of the EUSA index. The data was collected from 12/31/2006 to 12/30/2016, from Wharton Research Data Services (WRDS) for the 908 historical constituents of the USA Equal Weight (EUSA) index, of which USMV is derived. Each tickers' 252-day (annual) trailing volatility was calculated and a month end spagetti plot was produced.\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\n\nhead(monthly_rolling_vol)\ntail(monthly_rolling_vol)\nsummary(monthly_rolling_vol)\n\n# Spaggeti plot for monthly trailing vol\nggplot(monthly_rolling_vol, aes(Date, Volatility, group = Ticker)) + geom_line()\n```\n\n## EUSA Constituent Trailing Betas \nData was collected from the past 10 years of the EUSA index. The data was collected from 12/31/2006 to 12/30/2016, was collected from WRDS for the 908 historical constituents of the USA Equal Weight (EUSA) index, of which USMV is derived. Each tickers' 252-day (annual) trailing beta was calculated and a month end spagetti plot was produced.\n\n```{r, echo = FALSE}\nlibrary(ggplot2)\n\nhead(monthly_beta_values)\ntail(monthly_beta_values)\nsummary(monthly_beta_values)\n\n# Spaggeti plot for monthly Beta\nggplot(monthly_beta_values, aes(Date, Beta, group = Ticker)) + geom_line()\n```\n\n## EUSA Constituent Price to Book Ratios \nData was collected from the past 10 years of the EUSA index. The data was collected from 12/31/2006 to 12/30/2016, from WRDS for the 908 historical constituents of the USA Equal Weight (EUSA) index, of which USMV is derived. Each tickers' Price to Book ratio was calculated in two ways, to ensure accuracy. \n\n```{r, echo = FALSE}\nlibrary(ggplot2)\n\nhead(book_value_data)\ntail(book_value_data)\nsummary(book_value_data)\n```\n\n# Data Distribution \nThe distribution of the predictor variable, if the stock is in the index now, with respect to each response variable is shown below. \n\n## Index now vs. Trailing Volatility \n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=volatility, y=index_now)) + geom_point()\n```\n\n## Index now vs. Trailing Beta \n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=beta, y=index_now)) + geom_point() \n```\n\n## Index now vs. Price to Book Ratio \n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=price_to_book, y=index_now)) + geom_point() \n```\n\n## Index now vs. Index 6 months ago\n```{r, echo = FALSE}\nggplot(monthly_final, aes(x=index_before, y=index_now)) + geom_point()\n```\n\n\n\n\n\n",
    "created" : 1509396875410.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "0|42|19|0|\n",
    "hash" : "855791991",
    "id" : "A2996E33",
    "lastKnownWriteTime" : 1509417465,
    "last_content_update" : 1509417465050,
    "path" : "~/thesis_final/index/03-chap3.Rmd",
    "project_path" : "index/03-chap3.Rmd",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}